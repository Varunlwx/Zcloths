{% extends "base.html" %}

{% block title %}Order Detail - ZEECLOTHS{% endblock %}

{% block extra_css %}
<style>
/* Admin Order Detail Page Styles - Updated to match index page aesthetic */
html, body {
  margin: 0;
  height: 100%;
  background: #000;
  font-family: Poppins, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  overflow-x: hidden;
  scroll-behavior: smooth;
}

/* Admin Navbar - White text override */
.navbar .brand {
  color: #ffffff !important;
}

.navbar .nav-list a {
  color: #ffffff !important;
}

.navbar .nav-list a:hover {
  color: #22d3ee !important;
}

.navbar .nav-list a.active {
  color: #22d3ee !important;
}

.navbar .profile-icon {
  color: #ffffff !important;
}

.navbar .profile-icon:hover {
  background: rgba(255, 255, 255, 0.1) !important;
  color: #22d3ee !important;
}



.navbar .welcome-text {
  color: #ffffff !important;
}

.navbar .dropdown-item {
  color: #ffffff !important;
}

.navbar .dropdown-item:hover {
  background: rgba(255, 255, 255, 0.1) !important;
  color: #22d3ee !important;
}

.navbar .search-input {
  color: #ffffff !important;
  background: rgba(255, 255, 255, 0.1) !important;
  border: 1px solid rgba(255, 255, 255, 0.3) !important;
}

.navbar .search-input::placeholder {
  color: rgba(255, 255, 255, 0.6) !important;
}

.navbar .search-input:focus {
  background: rgba(255, 255, 255, 0.15) !important;
  border-color: #22d3ee !important;
}

.admin-order-detail-page {
  position: relative;
  min-height: 100vh;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(20px);
  padding: 120px 0 80px;
  font-family: Poppins, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
}

.page-header {
  text-align: center;
  margin-bottom: 3rem;
}

.page-header h1 {
  font-size: 3rem;
  font-weight: 700;
  background: linear-gradient(135deg, #fff 0%, #a8a8a8 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 1rem;
  animation: fadeInUp 0.8s ease-out;
}

.back-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem 2rem;
  background: rgba(255, 255, 255, 0.05);
  color: rgba(255, 255, 255, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 0;
  text-decoration: none;
  font-weight: 500;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
  font-family: Poppins, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
}

.back-btn:hover {
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
  border-color: rgba(255, 255, 255, 0.2);
  transform: translateY(-2px);
}

.back-btn svg {
  width: 16px;
  height: 16px;
}

.order-details-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 2rem;
  margin-bottom: 3rem;
  animation: fadeInUp 0.8s ease-out 0.1s both;
}

.order-info, .customer-info, .shipping-info, .billing-info {
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 0;
  padding: 2rem;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  transition: transform 0.3s ease;
}

.order-info:hover, .customer-info:hover, .shipping-info:hover, .billing-info:hover {
  transform: translateY(-5px);
}

.order-info h2, .customer-info h2, .shipping-info h2, .billing-info h2 {
  color: #fff;
  margin-bottom: 1.5rem;
  font-size: 1.3rem;
  font-weight: 600;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  padding-bottom: 0.5rem;
}

.info-card {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 0;
  padding: 1.5rem;
}

.info-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.info-row:last-child {
  border-bottom: none;
}

.label {
  font-weight: 500;
  color: rgba(255, 255, 255, 0.7);
  font-size: 0.95rem;
}

.value {
  color: #fff;
  font-weight: 600;
  font-size: 1rem;
}

.status-badge {
  padding: 0.5rem 1rem;
  border-radius: 0;
  font-size: 0.85rem;
  font-weight: 600;
  border: 1px solid rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(10px);
}

.status-pending { 
  background: rgba(255, 193, 7, 0.1); 
  color: #ffc107; 
  border-color: rgba(255, 193, 7, 0.3);
}
.status-processing { 
  background: rgba(13, 110, 253, 0.1); 
  color: #0d6efd; 
  border-color: rgba(13, 110, 253, 0.3);
}
.status-shipped { 
  background: rgba(25, 135, 84, 0.1); 
  color: #198754; 
  border-color: rgba(25, 135, 84, 0.3);
}
.status-delivered { 
  background: rgba(25, 135, 84, 0.15); 
  color: #20c997; 
  border-color: rgba(25, 135, 84, 0.4);
}
.status-cancelled { 
  background: rgba(220, 53, 69, 0.1); 
  color: #dc3545; 
  border-color: rgba(220, 53, 69, 0.3);
}

.order-items {
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 0;
  padding: 2.5rem;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  margin-bottom: 2rem;
  animation: fadeInUp 0.8s ease-out 0.2s both;
}

.order-items h2 {
  color: #fff;
  margin-bottom: 2rem;
  font-size: 1.5rem;
  font-weight: 600;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  padding-bottom: 0.5rem;
}

.items-table {
  overflow-x: auto;
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  padding: 1.5rem;
  text-align: left;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

th {
  background: rgba(255, 255, 255, 0.05);
  font-weight: 600;
  color: #fff;
  font-size: 0.95rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

td {
  color: rgba(255, 255, 255, 0.9);
  font-size: 0.95rem;
}

.product-info {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.product-thumb {
  width: 60px;
  height: 60px;
  object-fit: cover;
  border-radius: 0;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.product-info h4 {
  margin: 0 0 0.25rem 0;
  color: #fff;
  font-weight: 600;
}

.product-info p {
  margin: 0;
  color: rgba(255, 255, 255, 0.7);
  font-size: 0.85rem;
  line-height: 1.4;
}

.order-actions {
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 0;
  padding: 2.5rem;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  animation: fadeInUp 0.8s ease-out 0.3s both;
}

.order-actions h2 {
  color: #fff;
  margin-bottom: 1.5rem;
  font-size: 1.3rem;
  font-weight: 600;
}

.status-form {
  display: flex;
  gap: 1.5rem;
  align-items: center;
}

.status-form select {
  padding: 1rem;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 0;
  font-size: 1rem;
  color: #fff;
  min-width: 180px;
  font-family: Poppins, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  transition: all 0.3s ease;
}

.status-form select:focus {
  outline: none;
  border-color: rgba(255, 255, 255, 0.3);
  background: rgba(255, 255, 255, 0.1);
  box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
}

.status-form select option {
  background: #000;
  color: #fff;
}

.btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem 2rem;
  border: none;
  border-radius: 0;
  font-size: 1rem;
  font-weight: 500;
  text-decoration: none;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: Poppins, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
}

.btn-primary {
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(10px);
}

.btn-primary:hover {
  background: rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
}

.btn svg {
  width: 16px;
  height: 16px;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (max-width: 768px) {
  .page-header h1 {
    font-size: 2.5rem;
  }
  
  .order-details-grid {
    grid-template-columns: 1fr;
  }
  
  .status-form {
    flex-direction: column;
    align-items: stretch;
  }
  
  .items-table {
    font-size: 0.9rem;
  }
  
  .product-info {
    flex-direction: column;
    text-align: center;
  }
  
  .info-row {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }
  
  th, td {
    padding: 1rem;
  }
}
</style>
{% endblock %}

{% block content %}
<div class="admin-order-detail-page">
  <div class="container">
    <div class="page-header">
        <h1>Order #{{ order.order_number }}</h1>
      <a href="{{ url_for('admin.orders') }}" class="back-btn">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Back to Orders
        </a>
    </div>

    <div class="order-details-grid">
        <div class="order-info">
            <h2>Order Information</h2>
            <div class="info-card">
                <div class="info-row">
                    <span class="label">Order Number:</span>
                    <span class="value">{{ order.order_number }}</span>
                </div>
                <div class="info-row">
                    <span class="label">Date:</span>
                    <span class="value">{{ order.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
                </div>
                <div class="info-row">
                    <span class="label">Status:</span>
                    <span class="value">
                        <span class="status-badge status-{{ order.status }}">{{ order.status.title() }}</span>
                    </span>
                </div>
                <div class="info-row">
                    <span class="label">Total Amount:</span>
                    <span class="value">₹{{ "%.0f"|format(order.total_amount) }}</span>
                </div>
                <div class="info-row">
                    <span class="label">Payment Method:</span>
                    <span class="value">{{ order.payment_method or 'Not specified' }}</span>
                </div>
            </div>
        </div>

        <div class="customer-info">
            <h2>Customer Information</h2>
            <div class="info-card">
                <div class="info-row">
                    <span class="label">Name:</span>
                    <span class="value">{{ order.user.first_name }} {{ order.user.last_name }}</span>
                </div>
                <div class="info-row">
                    <span class="label">Email:</span>
                    <span class="value">{{ order.user.email }}</span>
                </div>
                <div class="info-row">
                    <span class="label">Phone:</span>
                    <span class="value">{{ order.user.phone or 'Not provided' }}</span>
                </div>
            </div>
        </div>

        <div class="shipping-info">
            <h2>Shipping Address</h2>
            <div class="info-card">
          <p style="color: rgba(255, 255, 255, 0.9); line-height: 1.6; margin: 0;">{{ order.shipping_address or 'No shipping address provided' }}</p>
            </div>
        </div>

        <div class="billing-info">
            <h2>Billing Address</h2>
            <div class="info-card">
          <p style="color: rgba(255, 255, 255, 0.9); line-height: 1.6; margin: 0;">{{ order.billing_address or 'No billing address provided' }}</p>
            </div>
        </div>
    </div>

    <div class="order-items">
        <h2>Order Items</h2>
        <div class="items-table">
            <table>
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Size</th>
                        <th>Color</th>
                        <th>Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in order.items %}
                    <tr>
                        <td>
                            <div class="product-info">
                                <img src="{{ item.product.image_url }}" alt="{{ item.product.name }}" class="product-thumb">
                                <div>
                                    <h4>{{ item.product.name }}</h4>
                                    <p>{{ item.product.description[:50] }}...</p>
                                </div>
                            </div>
                        </td>
                        <td>₹{{ "%.0f"|format(item.price) }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>{{ item.size or 'N/A' }}</td>
                        <td>{{ item.color or 'N/A' }}</td>
                        <td>₹{{ "%.0f"|format(item.price * item.quantity) }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="order-actions">
        <h2>Update Order Status</h2>
        <form method="POST" action="{{ url_for('admin.update_order_status', order_id=order.id) }}" class="status-form">
            <select name="status" required>
                <option value="pending" {% if order.status == 'pending' %}selected{% endif %}>Pending</option>
                <option value="processing" {% if order.status == 'processing' %}selected{% endif %}>Processing</option>
                <option value="shipped" {% if order.status == 'shipped' %}selected{% endif %}>Shipped</option>
                <option value="delivered" {% if order.status == 'delivered' %}selected{% endif %}>Delivered</option>
                <option value="cancelled" {% if order.status == 'cancelled' %}selected{% endif %}>Cancelled</option>
            </select>
        <button type="submit" class="btn btn-primary">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Update Status
        </button>
        </form>
    </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Admin order detail page functionality
document.addEventListener('DOMContentLoaded', function() {
  // Add hover effects to info cards
  const infoCards = document.querySelectorAll('.order-info, .customer-info, .shipping-info, .billing-info');
  infoCards.forEach(card => {
    card.addEventListener('mouseenter', function() {
      this.style.transform = 'translateY(-5px)';
    });
    card.addEventListener('mouseleave', function() {
      this.style.transform = 'translateY(0)';
    });
  });

  // Add hover effects to table rows
  const tableRows = document.querySelectorAll('tbody tr');
  tableRows.forEach(row => {
    row.addEventListener('mouseenter', function() {
      this.style.backgroundColor = 'rgba(255, 255, 255, 0.05)';
    });
    row.addEventListener('mouseleave', function() {
      this.style.backgroundColor = 'transparent';
    });
  });

  // Status form validation
  const statusForm = document.querySelector('.status-form');
  if (statusForm) {
    statusForm.addEventListener('submit', function(e) {
      const status = this.querySelector('select[name="status"]').value;
      if (!status) {
        e.preventDefault();
        showNotification('Please select a status', 'error');
        return;
      }
      showNotification('Order status updated successfully!', 'success');
    });
  }

  // Animate status badges
  const statusBadges = document.querySelectorAll('.status-badge');
  statusBadges.forEach(badge => {
    badge.addEventListener('mouseenter', function() {
      this.style.transform = 'scale(1.05)';
    });
    badge.addEventListener('mouseleave', function() {
      this.style.transform = 'scale(1)';
    });
  });
});

function showNotification(message, type) {
  const notification = document.createElement('div');
  notification.className = `notification notification-${type}`;
  notification.textContent = message;
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 16px 24px;
    border-radius: 0;
    color: white;
    font-weight: 500;
    font-family: Poppins, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    z-index: 1000;
    ${type === 'success' ? 'background: rgba(16, 185, 129, 0.9);' : 'background: rgba(239, 68, 68, 0.9);'}
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    transform: translateX(100%);
    transition: transform 0.3s ease;
  `;
  document.body.appendChild(notification);
  setTimeout(() => { notification.style.transform = 'translateX(0)'; }, 100);
  setTimeout(() => {
    notification.style.transform = 'translateX(100%)';
    setTimeout(() => { notification.remove(); }, 300);
  }, 3000);
}
</script>
{% endblock %}


